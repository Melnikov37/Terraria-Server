{% extends "base.html" %}
{% block title %}World - Terraria Admin{% endblock %}

{% block content %}
<div class="header">
    <h2>World Controls</h2>
    <form method="POST" action="{{ url_for('save_world') }}" class="inline-form">
        <button type="submit" class="btn btn-success" {{ 'disabled' if not status.online }}>Save World</button>
    </form>
</div>

{% if not status.online %}
<div class="card">
    <p style="color: var(--text-muted);">Server is offline. Start the server to access world controls.</p>
</div>
{% else %}

<div class="grid grid-2">
    <div class="card">
        <div class="card-title">Time Control</div>
        <form method="POST" action="{{ url_for('set_time') }}">
            <div class="form-group">
                <label>Set Time</label>
                <select name="time">
                    <option value="day">Day (4:30 AM)</option>
                    <option value="noon">Noon (12:00 PM)</option>
                    <option value="night">Night (7:30 PM)</option>
                    <option value="midnight">Midnight (12:00 AM)</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Set Time</button>
        </form>
    </div>

    <div class="card">
        <div class="card-title">Broadcast Message</div>
        <form method="POST" action="{{ url_for('broadcast') }}">
            <div class="form-group">
                <label>Message</label>
                <input type="text" name="message" required placeholder="Message to all players">
            </div>
            <button type="submit" class="btn btn-primary">Send Broadcast</button>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-title">Quick Commands</div>
    <div class="btn-group" style="flex-wrap: wrap;">
        <form method="POST" action="{{ url_for('run_command') }}" class="inline-form">
            <input type="hidden" name="command" value="/blood">
            <button type="submit" class="btn btn-danger">Blood Moon</button>
        </form>
        <form method="POST" action="{{ url_for('run_command') }}" class="inline-form">
            <input type="hidden" name="command" value="/eclipse">
            <button type="submit" class="btn btn-danger">Solar Eclipse</button>
        </form>
        <form method="POST" action="{{ url_for('run_command') }}" class="inline-form">
            <input type="hidden" name="command" value="/invade goblins">
            <button type="submit" class="btn btn-warning">Goblin Invasion</button>
        </form>
        <form method="POST" action="{{ url_for('run_command') }}" class="inline-form">
            <input type="hidden" name="command" value="/invade pirates">
            <button type="submit" class="btn btn-warning">Pirate Invasion</button>
        </form>
        <form method="POST" action="{{ url_for('run_command') }}" class="inline-form">
            <input type="hidden" name="command" value="/rain">
            <button type="submit" class="btn btn-primary">Toggle Rain</button>
        </form>
        <form method="POST" action="{{ url_for('butcher') }}" class="inline-form">
            <button type="submit" class="btn btn-danger">Kill All Mobs</button>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-title">Execute Command</div>
    <form method="POST" action="{{ url_for('run_command') }}">
        <div class="form-group">
            <label>TShock Command</label>
            <input type="text" name="command" required placeholder="/command args">
            <small style="color: var(--text-muted); display: block; margin-top: 5px;">
                Examples: /time day, /rain, /spawnmob zombie 10, /give playername item
            </small>
        </div>
        <button type="submit" class="btn btn-primary">Execute</button>
    </form>
</div>

<div class="card">
    <div class="card-title">Common Commands Reference</div>
    <table class="table">
        <tr><td><code>/time day|night|noon|midnight</code></td><td>Set world time</td></tr>
        <tr><td><code>/rain</code></td><td>Toggle rain</td></tr>
        <tr><td><code>/blood</code></td><td>Start blood moon</td></tr>
        <tr><td><code>/eclipse</code></td><td>Start solar eclipse</td></tr>
        <tr><td><code>/invade &lt;type&gt;</code></td><td>Start invasion (goblins, pirates, snowmen, pumpkin, frost, martian)</td></tr>
        <tr><td><code>/spawnmob &lt;name&gt; &lt;amount&gt;</code></td><td>Spawn mobs</td></tr>
        <tr><td><code>/spawnboss &lt;name&gt;</code></td><td>Spawn boss (eow, eoc, kingslime, wof, etc.)</td></tr>
        <tr><td><code>/butcher</code></td><td>Kill all hostile NPCs</td></tr>
        <tr><td><code>/give &lt;player&gt; &lt;item&gt; &lt;amount&gt;</code></td><td>Give item to player</td></tr>
        <tr><td><code>/tp &lt;player1&gt; &lt;player2&gt;</code></td><td>Teleport player</td></tr>
        <tr><td><code>/heal &lt;player&gt;</code></td><td>Heal player</td></tr>
        <tr><td><code>/godmode &lt;player&gt;</code></td><td>Toggle godmode</td></tr>
    </table>
</div>

{% endif %}
{% endblock %}
