# Terraria Server Admin — TODO

## В работе / Planned

### 1. Авто-бекап миров
- [ ] Фоновый поток: каждый час копирует `worlds/*.wld` в `backups/auto/<timestamp>/`
- [ ] Хранить не более N последних авто-бекапов (настраивается через `BACKUP_KEEP_COUNT`)
- [ ] Страница `/backups` — список бекапов (авто + ручные) с датой/размером
- [ ] Кнопка "Create backup now" (ручной бекап)
- [ ] Кнопка "Restore" — останавливает сервер, копирует файл, запускает
- [ ] Кнопка "Delete" на каждый бекап

### 2. Лог-вьювер
- [ ] Страница `/logs` — вывод `journalctl -u terraria -n 500 --no-pager`
- [ ] Кнопка "Refresh", автообновление каждые 5 сек (JS fetch)
- [ ] Фильтрация: показывать только ERROR/WARNING строки
- [ ] Кнопка "Follow" — SSE-стрим новых строк в реальном времени

### 3. Публичная страница со списком модов
- [ ] Роут `/mods/list` — без авторизации (для игроков)
- [ ] Список установленных и включённых модов: название, версия, Workshop ID, ссылка
- [ ] Кнопка "Copy all IDs" для быстрого копирования
- [ ] Инструкция как установить моды (tModLoader → Mod Browser)

### 4. Мониторинг ресурсов
- [ ] Добавить `psutil` в requirements.txt
- [ ] Виджет на дашборде: CPU%, RAM (используется / всего), Disk (папка сервера)
- [ ] Отдельный API `/api/metrics` для JS-полинга
- [ ] Авто-обновление каждые 5 сек

### 5. Список игроков на дашборде
- [ ] Показывать онлайн-игроков прямо на главной странице (сейчас только на /players)
- [ ] Авто-обновление каждые 10 сек через JS fetch `/api/players`
- [ ] Показывать время онлайна если возможно

### 6. Смена мира без пересоздания
- [ ] Страница `/world` — добавить секцию "Switch World"
- [ ] Список `.wld` файлов из папки `worlds/`
- [ ] Выбор мира из дропдауна → обновляет `serverconfig.txt` → рестарт сервера
- [ ] Показывать текущий активный мир

### 7. tModLoader авто-апдейт
- [ ] Кнопка "Check for updates" в Config → сравнивает текущую версию с GitHub releases
- [ ] Кнопка "Update tModLoader" → скачивает новый zip, заменяет файлы, рестарт
- [ ] Бекап текущей версии перед обновлением
- [ ] Показывать changelog (ссылка на GitHub release)

## Сделано ✅

- [x] Поддержка tModLoader (установка, запуск через screen)
- [x] Управление модами: установка по Workshop ID, загрузка .tmod, enable/disable/delete
- [x] Авто-определение и установка зависимостей модов (парсинг бинарного Info файла)
- [x] Версия мода в списке, метаданные (workshop_id, last_updated)
- [x] Кнопки "Update" и "Update All" для модов
- [x] Фоновое авто-обновление модов (MOD_UPDATE_INTERVAL_HOURS)
- [x] Установка steamcmd через install.sh
- [x] Базовое управление игроками (kick, ban)
- [x] Управление миром (время, save, broadcast, raw command)
- [x] Конфигурация сервера через UI
